# 介绍

> 什么是WxPusher

**WxPusher** (微信推送服务)是一个使用微信公众号作为通道的，实时信息推送平台，你可以通过调用API的方式，把信息推送到微信上，无需安装额外的软件，即可做到信息实时通知。
你可以使用**WxPusher**来做服务器报警通知、抢课通知、抢票通知，信息更新提示等。

# 名词解释
## 应用
对应你的一个项目 ，主要用来做鉴权，资源隔离等（类比使用高德地图SDK、微信登录等，都会先新建一个应用），每个应用拥有独立的名字，二维码，回调地址，调用资源，鉴权信息等，发送消息第一步，需要先新建一个应用。

简单的理解，你有一个抢火车票的项目，抢到票了需要给用户发送信息；你还有一个服务器报警的项目，服务器有异常的时候，给相关负责人发送信息，这2个的用途是不一样的，你就可以创建2个应用来分别发送他们的信息。

用户可以通过二维码或者链接关注这个应用，关注我们会把用户的UID回调给你指定的服务器，你可以通过UID给这个用户发送信息。
## 主题(Topic)
**目前还在开发中...**

主题(Topic)是应用下面，一类消息的集合，比如创建了一个优惠相关的应用，用来给用户推送各种优惠信息，但是不同的用户关注的优惠信息不同，一部分人关注淘宝的，一部分人关注京东的。这种场景下，你就可以创建一个淘宝的主题，再创建一个京东的主题，发送信息的时候，直接发送到对应的主题即可，每个主题都有对应的订阅链接和二维码，用户订阅这个主题以后，就能接收这个主题下的信息了。

用户关注以后，无回调信息 。
## 应用和主题(Topic)的对比
项目|应用|主题(Topic)
:--:|:--:|:---:
概念|应用是一个独立的个体|主题属于应用，调用主题需要使用对应应用的APP_TOKEN授权
关注方式|二维码和链接|二维码和链接
发送群体|通过UID一对一发送|消息发送主题后，主题再分发给关注主题的用户，属于群发

## 各种二维码

项目|应用二维码|主题二维码
:--:|:--:|:---:
用途|用于微信用户关注应用，用户只有关注了你的应用，<br />你才能拿到他的UID，才能给他发送信息|用于订阅主题，用户订阅主题以后，你不能拿到它的UID
动静态|默认动态二维码|默认动态二维码

**动态二维码**：二维码链接不会变，但是二维码图形会变 ，因此只能使用动态二维码链接，不对截图、打印等。

**静态二维码**：二维码链接和图形都不变，可以随意使用。

## APP_TOKEN
应用的身份标志，这个只能开发者你本人知道 ，拥有APP_TOKEN，就可以给对应的应用的用户发送消息 ，所以请严格保密，不要发送到github之类的地方。
## UID
微信用户标志，在单独给某个用户发送消息时，来说明要发给哪个用户。

# 快速接入

## 注册并且创建应用
  
[打开开发者首页](http://wxpusher.zjiecode.com) ，使用微信扫码登录，无需注册，新用户首次扫码自动注册。

创建一个应用，如下图：

![创建应用](imgs/create_app.png  ':size=250')

回调地址：可以不填写，不填写用户关注的时候，就不会有回调，你不能拿到用户的UID

关注提示：用户关注或者扫应用码的时候发送给用户的提示，你可以不填写，Wxpusher会提供一个默认文案。你也可以在用户关注回调给你UID的时候，再主动推送一个提示消息给用户。
## 扫码关注应用
创建应用以后，你可以看到应用的应用码和关注链接，你可以让你的用户通过下面2种方式来关注你的应用，关注你的应用以后，你就可以给他发送消息了。

![创建应用](imgs/subscribe.png  ':size=350')


# 发送消息
## http调用
- POST接口
  POST接口是功能完整的接口，推荐使用。

  ContentType:application/json

  请求数据放在body里面，具体参数如下：

  ```json
  {
    "appToken":"AT_qHT0cTQfLwYOlBV9cJj9zDSyEmspsmyM",
    "content":"Wxpusher祝你中秋节快乐!",
    "contentType":1,//内容类型 1表示文字  2表示html 3表示markdown
    "topicIds":[ //发送目标的topicId，是一个数组！！！
        123
    ],
    "uids":[//发送目标的UID，是一个数组！！！
        "c1BcpqxEbD8irqlGUh9BhOqR2BvH8yWZ"
    ],
    "url":"http://wxpusher.zjiecode.com" //原文链接，可选参数
}
  ```
- GET接口
  GET接口是对POST接口的阉割，主要是为了某些情况下调用方便，只支持对文字（contentType=1）的发送，举例：
  ```
  http://wxpusher.test.zjiecode.com/api/send/message/?appToken=AT_qHT0cTQfLwYOlBV9cJj9zDSyEmspsmyM&content=123&uid=c1BcpqxEbD8irqlGUh9BhOqR2BvH8yWZ&url=http%3a%2f%2fwxpusher.zjiecode.com
  ```
  请求参数：appToken、uid、topicId、content、url ，其中content和url请进行urlEncode编码。

## Java SDK

为了方便快速接入，开发了Java的接入SDK ，[https://github.com/zjiecode/wxpusher-client](https://github.com/zjiecode/wxpusher-client).

目前只封装了Java的版本，其他语言请使用Http，如果你有进行封装，也欢迎PR。